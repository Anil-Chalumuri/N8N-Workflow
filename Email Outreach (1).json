{
  "name": "Email Outreach",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -144,
        480
      ],
      "id": "9c475ab5-cc68-4670-9921-24f3f411b3bd",
      "name": "50",
      "disabled": true
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json['n8n staus'] }}",
                    "rightValue": "To do",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e2c86968-5855-4cee-afce-4a4bd38d73f4"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Send 1st Email"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8fa0db76-1329-4088-8e3d-02b19bcdc0dc",
                    "leftValue": "={{ $json['n8n staus'] }}",
                    "rightValue": "1st Sent",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Send 2nd Mail"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "04709582-179e-42dc-9290-b011a60e464a",
                    "leftValue": "={{ $json['n8n staus'] }}",
                    "rightValue": "2nd Sent",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Send 3rd Mail"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -448,
        144
      ],
      "id": "c52e35b4-47eb-4962-92dd-93a2e10c60c8",
      "name": "Switch"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        96,
        -176
      ],
      "id": "4741a938-93dc-47ca-ab46-136d61abc6b3",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 9
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -864,
        160
      ],
      "id": "da6a0fc4-5ae6-4d0a-8c1f-a59ecffbd6bf",
      "name": "9 AM"
    },
    {
      "parameters": {
        "maxItems": 50
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -160,
        -176
      ],
      "id": "3ed9ad67-76a0-4ef5-9bf9-bc6174a2809f",
      "name": "Limit - 50"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $('dhurv.tomar').item.json.Email }}",
            "n8n staus": "1st Sent",
            "Email Id": "={{ $json.id }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "n8n staus",
              "displayName": "n8n staus",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User Reply",
              "displayName": "User Reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        784,
        -176
      ],
      "id": "d2e3eed6-d4cc-4b7d-8077-ce0b14008270",
      "name": "update_akshansh",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "amount": 12,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1024,
        -176
      ],
      "id": "fff2a659-73ab-4faa-b2d4-d41a40ffde2b",
      "name": "12 Minute",
      "webhookId": "a33c7eb1-9ed9-4781-861a-453b77dc2c76"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        144,
        144
      ],
      "id": "2e8e0454-4cf7-4412-8bce-f9ee1a6663f1",
      "name": "Loop Over Items",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -160,
        144
      ],
      "id": "395aeb76-5968-4fd4-b15e-d3fc7aa877d2",
      "name": "Limit 50",
      "disabled": true
    },
    {
      "parameters": {
        "sendTo": "={{ $('dhurv.tomar').item.json.Email }}",
        "subject": "Quick follow-up on your Onsite Software request",
        "emailType": "text",
        "message": "=Hi {{ $('dhurv.tomar').item.json['Full Name'] }} ,\n\nYou recently requested details about Onsite, but it looks like we havenâ€™t connected yet.\n\nMost teams reach out to us when managing labour, material, and site updates across WhatsApp & Excel starts getting messy â€” thatâ€™s exactly what Onsite fixes.\n\nIf it helps, I can quickly walk you through how teams like yours get better cost control and site visibility in just 10â€“15 minutes.\n\nJust reply â€œYesâ€, and Iâ€™ll set it up at your convenience.\n\nBest,\nDhruv Tomar\nProduct Consultant \nOnsiteteams.com",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        368,
        -160
      ],
      "id": "6b851f68-777d-4ff2-862a-17c796193cc5",
      "name": "Send a message",
      "webhookId": "1d9218ea-80cb-4e74-b2c1-e46198aa0b1d",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -688,
        160
      ],
      "id": "f5a2bc5d-1e57-467b-8484-5bd7c7b8d610",
      "name": "dhurv.tomar",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "content": "## Send Email \n- User reply email sent and this will update over google sheet",
        "height": 928,
        "width": 2192,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -912,
        -224
      ],
      "id": "0e5ec143-b388-4adf-a412-ca3ba2627a76",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n  const raw = item.json.snippet || \"\";\n\n  // Remove quoted reply history (everything after \"On ... wrote:\")\n  const cleanReply = raw.split(/On .* wrote:/i)[0].trim();\n\n  item.json.reply_body = cleanReply;\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2032,
        -32
      ],
      "id": "21784492-d67a-43ff-a940-c17af413cc2d",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyHour",
              "minute": 15
            }
          ]
        },
        "filters": {}
      },
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1.3,
      "position": [
        1392,
        -32
      ],
      "id": "00ceaf50-9464-49ec-b808-dbd0fdf47c53",
      "name": "dhruv.tomar@onsiteteams.com1",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Email Id",
              "lookupValue": "={{ $json.threadId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1648,
        -32
      ],
      "id": "8aa01350-8148-4fd9-83dd-5edec5a73cf3",
      "name": "dhurv.tomar2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fdcb6921-c564-4354-8ff2-8d5a6cd4f4e3",
              "name": "thred",
              "value": "={{ $('dhruv.tomar@onsiteteams.com1').item.json.threadId }}",
              "type": "string"
            },
            {
              "id": "7e3c3af2-715a-4454-8d85-43c381d62e5c",
              "name": "snippet",
              "value": "={{ $('dhruv.tomar@onsiteteams.com1').item.json.snippet }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1840,
        -32
      ],
      "id": "971d2177-b0ed-4ecc-9d3c-aee3ba984dbc",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "content": "## Update  Reply to Sheet\n- User reply email sent and this will update over google sheet\n- Email Marketing for Onsite - Middle East NATC",
        "height": 368,
        "width": 1664,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1312,
        -192
      ],
      "id": "6d118390-e095-468b-9ab2-2bf14f17b67f",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $('dhurv.tomar').item.json.Email }}",
            "n8n staus": "Error",
            "Email Id": "={{ $json.id }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "n8n staus",
              "displayName": "n8n staus",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User Reply",
              "displayName": "User Reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        704,
        -400
      ],
      "id": "8e8946e3-526b-4866-922c-75e1896bae19",
      "name": "update_akshansh3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "content": "## ERRO\n- Update n8n status to erro and contnue",
        "height": 272,
        "width": 592,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        576,
        -512
      ],
      "id": "8ac6b3e0-d6bd-4b32-a5f9-a4c54f19667d",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "amount": 1,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        960,
        -400
      ],
      "id": "171d07fe-1b78-4b0b-b46f-44d4e76c374a",
      "name": "1 Min",
      "webhookId": "a33c7eb1-9ed9-4781-861a-453b77dc2c76"
    },
    {
      "parameters": {
        "operation": "addLabels",
        "messageId": "={{ $json.id }}",
        "labelIds": [
          "Label_749035511103695885"
        ]
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        560,
        -176
      ],
      "id": "04002007-a90d-44a6-bd5e-9e7663b495b3",
      "name": "Add label to message",
      "webhookId": "5349758e-602b-4e8f-9fbb-b4902fc2c376",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Code in JavaScript2').item.json.reply_body }}",
                    "rightValue": "Address not found",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "77d28864-04a9-49e8-97a5-815d7835a9a2"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        2480,
        -32
      ],
      "id": "c145dc40-5505-4707-b505-28f15e478589",
      "name": "Switch1"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email Id": "={{ $json.thred }}",
            "User Reply": "={{ $json.reply_body }}"
          },
          "matchingColumns": [
            "Email Id"
          ],
          "schema": [
            {
              "id": "n8n staus",
              "displayName": "n8n staus",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User Reply",
              "displayName": "User Reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2272,
        -32
      ],
      "id": "ae3c07fb-f620-4503-b9c2-c904e0c303f0",
      "name": "update reply",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email Id": "={{ $json['Email Id'] }}",
            "n8n staus": "Error"
          },
          "matchingColumns": [
            "Email Id"
          ],
          "schema": [
            {
              "id": "n8n staus",
              "displayName": "n8n staus",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "User Reply",
              "displayName": "User Reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2736,
        -32
      ],
      "id": "ee2458b6-6750-4432-a895-cf1da37977a0",
      "name": "Update error if found",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $('dhurv.tomar').item.json.Email }}",
            "n8n staus": "1st Sent",
            "Email Id": "={{ $json.id }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "n8n staus",
              "displayName": "n8n staus",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User Reply",
              "displayName": "User Reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        800,
        176
      ],
      "id": "c641e1b1-cd5a-4429-8ae0-95bfbbf192b3",
      "name": "update_akshansh1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "amount": 12,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1040,
        176
      ],
      "id": "6be670d2-57f8-4b4a-be76-47f74c214e09",
      "name": "12 Minute1",
      "webhookId": "a33c7eb1-9ed9-4781-861a-453b77dc2c76"
    },
    {
      "parameters": {
        "sendTo": "={{ $('dhurv.tomar').item.json.Email }}",
        "subject": "Quick follow-up on your Onsite Software request",
        "emailType": "text",
        "message": "=Hi {{ $('dhurv.tomar').item.json['Full Name'] }} ,\n\nYou recently requested details about Onsite, but it looks like we havenâ€™t connected yet.\n\nMost teams reach out to us when managing labour, material, and site updates across WhatsApp & Excel starts getting messy â€” thatâ€™s exactly what Onsite fixes.\n\nIf it helps, I can quickly walk you through how teams like yours get better cost control and site visibility in just 10â€“15 minutes.\n\nJust reply â€œYesâ€, and Iâ€™ll set it up at your convenience.\n\nBest,\nDhruv Tomar\nProduct Consultant \nOnsiteteams.com",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        384,
        160
      ],
      "id": "e1a90893-33d6-464e-b997-c53066092b51",
      "name": "Send a message1",
      "webhookId": "1d9218ea-80cb-4e74-b2c1-e46198aa0b1d",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "addLabels",
        "messageId": "={{ $json.id }}",
        "labelIds": [
          "Label_749035511103695885"
        ]
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        592,
        176
      ],
      "id": "160da6ce-148b-4373-a470-51158a055638",
      "name": "Add label to message1",
      "webhookId": "5349758e-602b-4e8f-9fbb-b4902fc2c376",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        112,
        480
      ],
      "id": "5a6a5ae7-cdd5-45ec-acad-32ae4e2792af",
      "name": "Loop Over Items1",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80",
          "mode": "list",
          "cachedResultName": "Email Marketing for Onsite",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1568055617,
          "mode": "list",
          "cachedResultName": "Middle East NATC",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1794Jpr_0uRhINgfx9DS_WGH_at9EHXs47QaLo8UVK80/edit#gid=1568055617"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $('dhurv.tomar').item.json.Email }}",
            "n8n staus": "1st Sent",
            "Email Id": "={{ $json.id }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "n8n staus",
              "displayName": "n8n staus",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User Reply",
              "displayName": "User Reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        768,
        512
      ],
      "id": "507e9b2c-d2eb-4462-9c46-6b53587da9c4",
      "name": "update_akshansh2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZW432FGOrLi3mugw",
          "name": "dhruv.tomar@Onsiteteams.com"
        }
      }
    },
    {
      "parameters": {
        "amount": 12,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1008,
        512
      ],
      "id": "4876ea26-50f3-4f04-9445-d8411a8e7e76",
      "name": "12 Minute2",
      "webhookId": "a33c7eb1-9ed9-4781-861a-453b77dc2c76"
    },
    {
      "parameters": {
        "sendTo": "={{ $('dhurv.tomar').item.json.Email }}",
        "subject": "Quick follow-up on your Onsite Software request",
        "emailType": "text",
        "message": "=Hi {{ $('dhurv.tomar').item.json['Full Name'] }} ,\n\nYou recently requested details about Onsite, but it looks like we havenâ€™t connected yet.\n\nMost teams reach out to us when managing labour, material, and site updates across WhatsApp & Excel starts getting messy â€” thatâ€™s exactly what Onsite fixes.\n\nIf it helps, I can quickly walk you through how teams like yours get better cost control and site visibility in just 10â€“15 minutes.\n\nJust reply â€œYesâ€, and Iâ€™ll set it up at your convenience.\n\nBest,\nDhruv Tomar\nProduct Consultant \nOnsiteteams.com",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        352,
        496
      ],
      "id": "64c6d860-78d8-49d3-ba0c-93a5744acef6",
      "name": "Send a message2",
      "webhookId": "1d9218ea-80cb-4e74-b2c1-e46198aa0b1d",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "addLabels",
        "messageId": "={{ $json.id }}",
        "labelIds": [
          "Label_749035511103695885"
        ]
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        560,
        512
      ],
      "id": "053fa23b-50a2-4906-a72a-e7de0d0ffc91",
      "name": "Add label to message2",
      "webhookId": "5349758e-602b-4e8f-9fbb-b4902fc2c376",
      "credentials": {
        "gmailOAuth2": {
          "id": "srRiEdXhbwTntHXO",
          "name": "Dhruv"
        }
      }
    },
    {
      "parameters": {
        "content": "## ðŸ“§ n8n Email Outreach Automation â€” CRM to Inbox\n\n### â­ What this workflow does\n- Pulls fresh and old leads directly from **Google Sheets** (CRM export).\n- Segments leads automatically based on **email templates** (Template 1 / 2 / 3).\n- Sends **personalized outreach emails** at scale using Gmail.\n- Applies Gmail **labels**, tracks delivery, and logs status back to the sheet.\n- Captures **real-time replies** and updates the CRM sheet instantly.\n- Handles **errors, retries, and delays** without manual intervention.\n\n### âš™ï¸ How it works (step-by-step)\n1. â° **Scheduled trigger** runs daily or at a fixed time.\n2. ðŸ“„ **Reads leads** from Google Sheets.\n3. ðŸ”€ **Switch logic** routes each lead to the correct email template.\n4. ðŸ” **Loop + rate limit** ensures safe sending (no spam flags).\n5. âœ‰ï¸ **Email sent via Gmail** with labels applied.\n6. ðŸ“Š **Sheet updated** with sent / replied / error status.\n7. ðŸ§  **Reply listener** tracks incoming replies and updates the sheet in real time.\n\n### ðŸš€ Why this matters (business impact)\n- Brings **dead CRM leads back to life** automatically.\n- Turns a simple **Excel/Sheet into a live outbound system**.\n- Gives **real-time visibility** on whatâ€™s working and whatâ€™s not.\n- Reduces dependency on manual SDR follow-ups.\n- Scales outbound outreach **without increasing headcount**.\n- Follow-ups happen on time â€” every time.\n\n### ðŸŽ¯ Ideal use case\n- Import leads (old or new) into Google Sheets.\n- Connect this automation once.\n- Let n8n handle **outreach, follow-ups, replies, and tracking** in real time.\n\n> *Consistent follow-ups win deals. Automation just makes sure you never miss one.*",
        "height": 832,
        "width": 624,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1600,
        -224
      ],
      "id": "40f17fb9-eb1b-4f54-8df2-6a1dd0bfd453",
      "name": "Sticky Note3"
    }
  ],
  "pinData": {},
  "connections": {
    "50": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Limit - 50",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Limit 50",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "50",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [],
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "9 AM": {
      "main": [
        [
          {
            "node": "dhurv.tomar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit - 50": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "update_akshansh": {
      "main": [
        [
          {
            "node": "12 Minute",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "12 Minute": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit 50": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        [
          {
            "node": "Add label to message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "update_akshansh3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dhurv.tomar": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "update reply",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dhruv.tomar@onsiteteams.com1": {
      "main": [
        [
          {
            "node": "dhurv.tomar2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dhurv.tomar2": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "update_akshansh3": {
      "main": [
        [
          {
            "node": "1 Min",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1 Min": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add label to message": {
      "main": [
        [
          {
            "node": "update_akshansh",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Update error if found",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "update reply": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "update_akshansh1": {
      "main": [
        [
          {
            "node": "12 Minute1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message1": {
      "main": [
        [
          {
            "node": "Add label to message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add label to message1": {
      "main": [
        [
          {
            "node": "update_akshansh1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Send a message2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "update_akshansh2": {
      "main": [
        [
          {
            "node": "12 Minute2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message2": {
      "main": [
        [
          {
            "node": "Add label to message2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add label to message2": {
      "main": [
        [
          {
            "node": "update_akshansh2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "12 Minute1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "12 Minute2": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Kolkata",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "versionId": "932ee0e3-179b-4ee0-93bb-ba74773c93d4",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "dd0454bdfa6e4c38befb0f0eb49a14f1c8f214aea4bf80232457a183fc065464"
  },
  "id": "lDqykEJE9nLik2CF",
  "tags": []
}